{% extends  'home.html' %}
{% load static %}
{% block head %}


    <script src="{% static 'lib/DataTables/datatables.min.js'  %}"></script>

    <!-- jQuery -->
{#<script src="https://code.jquery.com/jquery-3.7.0.js"></script>#}
{#<!-- DataTables JS -->#}
{#<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>#}
{#<!-- DataTables Bootstrap 5 JS -->#}
{#<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>#}


{% endblock %}
{% block content %}
{#    <p>Hola vista de productos </p>#}
{#    <p>{{ title }} </p>#}
{#<ul>#}
{#{% for produ in products %}#}
{#<li>{{ produ.name }}</li>#}
{#{% endfor %}#}
{#</ul>#}

<div class="card" >
<div class="card-header">
    <h3 class="card-title" >
        <i  ></i>
        {{ title }}
    </h3>
</div>
    <div class="card-body" >

    <table class="table" id="datatableid" >
      <thead>
      {% block columns %}

      {% endblock %}
{#        <tr>#}
{#          <th scope="col">#</th>#}
{#          <th scope="col">Nombre</th>#}
{#            <th scope="col" > Operaciones</th>#}
{#        </tr>#}
      </thead>
      <tbody>
      {% block rows %}

      {% endblock %}
{#      {% for produ in products %}#}
{#          <tr>#}
{#            <td> {{ produ.id }} </td>#}
{#            <td> {{ produ.name }} </td>#}
{#            <td>#}
{#            <button type="button" class="btn btn-info "> <i class="fa-regular fa-pen-to-square"></i> E </button>#}
{##}
{#            <button type="button" class="btn btn-danger "> <i class="fa-regular fa-trash-can"></i> D </button>#}
{#            </td>#}
{#          </tr>#}
{#      {% endfor %}#}


      </tbody>
    </table>
 </div>
    <div class="card-footer">
    <a href="{{ create_url }}" class="btn btn-primary " id="btnNew" >  <i class="fa-regular fa-trash-can "></i>Nuevo registro</a>
    </div>
</div>
{% endblock %}
{% block javascript %}
    <script>

    document.addEventListener('DOMContentLoaded', () => {

        const table = new DataTable('#datatableid', {
            responsive: true,
            autoWidth: true
        });

        const btnNew = document.getElementById('btnNew');

        btnNew.addEventListener('click', async function () {

            {#const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value; usar cuando arregle lo de los tokcens#}

            try {
                const response = await fetch("{% url 'baseu:product_list' %}", {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': csrfToken
                        {#usar cuando arregle lo de los tockens ahorita s tengo decorador#}
                    },
                    body: JSON.stringify({ id: 1 })
                });

                const data = await response.json();
                console.log("xito:", data);

            } catch (error) {
                console.error("Error:", error);
            } finally {
                console.log("Petici贸n completada");
            }

        });

    });

    /*    {#despues de debe agregar resposive para cambiar tamano y otras porpiedades autowith y resposive#}
 const table =  new DataTable('#datatableid',{
    responsive:true,
    autoWidth:true

});

document.getElementById('btnNew')
  .addEventListener('click', function () {
    alert('Click funcionando ');
      $.ajax({
        url: '{% url 'baseu:product_list' %}',
        type: 'POST',
        data: { id: 1},
              dataType:'json',
        success: function(respuesta) {
            console.log(respuesta);
        },
        error: function(error) {
            console.error(error);
        }
        }).done(function(data, textStatus, jqXHR) {
            // C贸digo a ejecutar si la petici贸n fue exitosa
            console.log("xito:", data);
        }).fail(function(jqXHR, textStatus, errorThrown) {
            // C贸digo a ejecutar si la petici贸n falla
            console.error("Error:", textStatus);
        }).always(function() {
            // C贸digo que se ejecuta siempre, al finalizar
            console.log("Petici贸n completada");
        });
        });

      $(document).ready(function() {
        $('#datatableid').DataTable();
    });*/
    </script>
{% endblock %}